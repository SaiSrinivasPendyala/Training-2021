<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Welcome to Narayana College</title>
	<h1 style="text-align: center;" class="header">Sri Chaitanya Junior College</h1>
	<button onclick="addEmptyObject();showAllItems();" class="button">Add Syllabus</button>
	
<style type="text/css">
	.text-center {
  		text-align: center;
	}
	.button {
		border-radius: 10px;
		background-color: #008CBA;
		border: none;
		color: white;
		padding: 15px 32px;
		text-align: center;
		text-decoration: none;
		display: inline-block;
		font-size: 16px;
	}
	.header {
		font-family: cursive;
		font-size: 400%;
	}
	.alignCenter {
  		width: 100%;
  		text-align: center;
	}
</style>
</head>
<body style="background-color:lightgreen;">
  	<!-- <button onclick="addEmptyObject();showAllItems();" class="button">Add Syllabus</button> -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script type="text/javascript">
	var items = [];
	function addEmptyObject() {
		var item = {"title":"", "description":"", "editMode":true};
		items.push(item);
	}

	function buildForm(itemIndex) {
		// items[index]["editMode"] = false;
		var title = items[itemIndex]["title"];
		var description = items[itemIndex]["description"];
		var $form = $('<form></form');
		var itemTemplate = `<br><br><p><b>SYLLABUS${itemIndex + 1}</b></p>
		<br><label>TITLE</label><br>
		<input type="text" id="title${itemIndex}" name="title${itemIndex}" placeholder="Enter Syllabus Title" value="${title}" size="51"><label id="message1" style="color:red; visibility:hidden;">Enter Valid Title!</label><br>
		<br><label>DESCRIPTION</label><br>
		<textarea id="description${itemIndex}" name="description${itemIndex}" placeholder="Enter Syllabus Description" rows="2" cols="61">${description}</textarea><label id="message2" style="color:red; visibility:hidden;">Enter Valid Description!</label><br>
		<p><input type="button" value="Save" onclick="saveItem(${itemIndex});showAllItems();validateForm(${itemIndex})">
		   <input type="button" value="Cancel" onclick="cancelEditing(${itemIndex});showAllItems();">
		</p>`;
		$form.append(itemTemplate);
		return $form;
	}

	function buildCard(itemIndex) {
		var title = items[itemIndex]["title"];
		var description = items[itemIndex]["description"];
		var itemCard = `<form><br><label>${itemIndex + 1}</label>
		<b>${title}</b><br><p>${description}</p>
		<p>&emsp;&emsp;<button onclick="editItem(${itemIndex});showAllItems();">Edit</button>
		&emsp;<button onclick="deleteItem(${itemIndex});showAllItems();">Delete</button></form>`;
		return itemCard;
	}

	function editItem(itemIndex) {
		items[itemIndex]["editMode"] = true;
	}

	function cancelEditing(itemIndex) {
		if (isItemEmpty(itemIndex)) {
			items.splice(itemIndex, 1);
		}
		else {
			items[itemIndex]["editMode"] = false;
		}
	}

	function isItemEmpty(itemIndex) {
		return (items[itemIndex]["title"] === "" ? true : false);
	}

	function saveItem(itemIndex) {
		items[itemIndex]["editMode"] = false;
		var title = $(`#title${itemIndex}`).val().trim();
		var description = $(`#description${itemIndex}`).val().trim();
		items[itemIndex]["title"] = title;
		items[itemIndex]["description"] = description;
		console.warn("added", {items});
	}

	function deleteItem(itemIndex) {
		var confirmMessage = confirm("Are you sure you want to delete the Syllabus Item with\nTitle: " + items[itemIndex]["title"] +
			"\nDescription: " + items[itemIndex]["description"] + "?");
		if (confirmMessage) {
			items.splice(itemIndex, 1);
		}
	}

	function showAllItems() {
		$("#divItems").empty();
		var itemCounter = 0;
		for (const item of items) {
			// alert(syllabusItems[counter]["editMode"]);
			$("#divItems").append(items[itemCounter]["editMode"] ? buildForm(itemCounter) : buildCard(itemCounter));
			itemCounter++;
		}
	}

	// function validateForm(itemIndex) {
	// 	// var title = $(`#title${itemIndex}`);
	// 	// var description = $(`#description${itemIndex}`);
	// 	var title = document.getElementById(`title${itemIndex}`);
	// 	var description = document.getElementById(`description${itemIndex}`);
	// 	if (title.value.trim() == ) {
	// 		title.style.border = "solid 2px red";
	// 		$("#message1").style.visibility = "visible";
	// 		// alert("Blank Title!");
	// 		return false;
	// 	}
	// 	else if (description.value.trim() == ) {
	// 		description.style.border = "solid 2px red";
	// 		$("#message2").style.visibility = "visible";
	// 		// alert("Blank Description!");
	// 		return false;
	// 	}
	// 	else {
	// 		return true;
	// 	}
	// }
	</script>
	<div id="divItems" class="alignCenter"></div>
</body>
</html>